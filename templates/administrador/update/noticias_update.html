{% extends "layouts/admin-layout.html" %}

{% load static %}
{% load i18n %}
{% load widget_tweaks %}

{% block title_page %}
  Esparta Suites - Administración
{% endblock title_page %}

{% block modulo_label %}
  <span class="" id="gestionar-bancos">Actualizar Noticia o comunicado</span>
{% endblock modulo_label %}

{% block opc_panel_class %}
  class="col-lg-3 end-padding-left"
{% endblock opc_panel_class %}

{% block body_block %}
<div class="col-lg-12 mb-5 mb-lg-0 end-padding-right" id="Nueva-Noticia">
  <div class="container rounded modulo border-secondary pb-2">
    <div class="container pt-3 pb-1">

      <div class="divider mb-4"></div>
      <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <!-- <h3 class="text-center pt-2">Datos de la publicación</h3>
        <p class="text-center pb-2 text-dark">Haz un anuncio para que este sea visible en la cartelera informativa de la página.</p> -->
        
        <div class="form-group row">
          <label for="id_titulo" class="col-sm-2 col-form-label text-dark">Título:</label>
          <div class="col-sm-9">
            <input type="text" class="form-control text-dark" id="id_titulo" name="titulo" required value="{{noticia.initial.titulo}}">
          </div>
        </div>

        <div class="form-group row">
          <label for="id_descripcion" class="col-sm-2 col-form-label text-dark">Descripción:</label>
          <div class="col-sm-9">
            <textarea class="form-control text-dark" id="id_descripcion" name="descripcion" rows="10" required>{{noticia.initial.descripcion}}</textarea>
          </div>
        </div>
        
        <div class="form-group row">
          <label for="id_imagen" class="col-sm-2 col-form-label text-dark">Imagen:</label>
          <div class="col-sm-9">
            <input type="file" name="imagen" id="id_image_file" accept="image/*" onchange="readURL(this)">
          </div>
        </div>

        <div class="form-group row image-group" id="id_image_group">
          <label for="id_imagen" class="col-sm-2 col-form-label text-dark">Vista previa:</label>
          <div class="col-sm-8">
            <img class="img-fluid image" src="{{noticia.initial.imagen.url}}" id="id_image_display">
            <div class="middle">
              <div class="text rounded">Change image</div>
            </div>
          </div>
        </div>

        {% for field in form %}
					<p>
						{% for error in field.errors %}
							<p class="alert alert-danger">{{ error }}</p>
						{% endfor %}
					</p>
				{% endfor %}
				{% if form.non_field_errors %}
					<div class="alert alert-danger">
						<p>{{form.non_field_errors}}</p>
					</div>
				{% endif %}

        <button type="submit" class="btn btn-success col-sm-4 mt-3 move-up"><i class="fa fa-plus"></i> Actualizar publicación</button>
        <a href="/home/administrar/noticias" class="btn btn-danger col-sm-2 mt-3 ml-3 move-up"><i class="fa fa-remove"></i> Cancelar</a>
      </form>
    </div>
  </div>
</div>

<script type="text/javascript">
	document.getElementById('id_image_group').onclick = function(event){
    	document.getElementById('id_image_file').click();
    };

	function readURL(input){
		var reader = new FileReader();
		reader.onload = function (e) {
            $('#id_image_display')
                .attr('src', e.target.result)
        };
		reader.readAsDataURL(input.files[0]);
	}
</script>
{% endblock body_block %}